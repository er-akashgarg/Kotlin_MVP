resources:
- repo: self

queue:
  name: Hosted VS2017

  demands:
  - java
  - JDK
  - AndroidSDK


steps:
- task: Gradle@2
  displayName: 'gradlew build'
  inputs:
    workingDirectory: ''
    gradleWrapperFile: 'gradlew'
    gradleOptions: '-Xmx3072m'
    publishJUnitResults: false
    tasks: 'assembleDebug'

- task: AndroidSigning@3
  displayName: 'Signing and aligning APK file(s) **/*.apk'
  inputs:
    apksignerKeystoreFile: '8819d3d5-e854-4ce9-870f-b60aa83d28b6'
    apksignerKeystorePassword: android
    apksignerKeystoreAlias: mvpdemo
    apksignerKeyPassword: android
    apkFiles: '**/*.apk'

- task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: '$(System.DefaultWorkingDirectory)'
      name: 'drop'

- task: GooglePlayRelease@2
    inputs:
      apkFile: '**/*.apk'
      serviceEndpoint: 'staggingplay'
      track: 'internal'
